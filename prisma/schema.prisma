// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

model User {
  id         Int    @id @default(autoincrement())
  first_name String
  last_name  String
  gender     String
  email      String @unique
  password   String
  role       String

  Institution     Institution @relation(fields: [institutionName], references: [name])
  institutionName String
  Paper           Paper?      @relation(fields: [paperId], references: [id])
  paperId         Int?

  Papers PaperAuthors[]
}

model Institution {
  name  String @id
  users User[]
}

model PaperAuthors {
  paperId Int
  userId  Int
  paper   Paper @relation(fields: [paperId], references: [id])
  user    User  @relation(fields: [userId], references: [id])

  @@id([paperId, userId])
}

model Paper {
  id         Int    @id @default(autoincrement())
  paperTitle String
  abstract   String
  fileLink   String
  file       Bytes
  status     String @default("pending")

  sessionPapers SessionPaper[]
  Authors       PaperAuthors[]
  presenter     User           @relation(fields: [presenterId], references: [id])
  presenterId   Int
}

model Location {
  name     String    @id
  Sessions Session[]
}

model Session {
  id            Int            @id @default(autoincrement())
  name          String
  fromTime      String
  endTime       String
  location      Location       @relation(fields: [locationName], references: [name])
  locationName  String
  sessionPapers SessionPaper[]
}

model SessionPaper {
  sessionId Int
  paperId   Int
  session   Session @relation(fields: [sessionId], references: [id])
  paper     Paper   @relation(fields: [paperId], references: [id])

  @@id([sessionId, paperId])
}
